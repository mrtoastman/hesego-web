"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const index=require("./index-9c866aeb.js"),price=require("./price-d3e21aa4.js"),getters=require("./getters-6c916233.js"),getters$1=require("./getters-fd8a6c1d.js"),watchers=require("./watchers-203d7acd.js");require("./store-6708f186.js"),require("./index-f6f80680.js"),require("./add-query-args-17c551b6.js");const scProductSelectedPriceCss=":host{display:block}sc-form{width:100%}.selected-price{display:flex;align-items:center;gap:var(--sc-spacing-small);flex-wrap:wrap}.selected-price__wrap{display:flex;align-items:baseline;flex-wrap:wrap;gap:var(--sc-spacing-xx-small);color:var(--sc-selected-price-color, var(--sc-color-gray-800));line-height:1}.selected-price__price{font-size:var(--sc-font-size-xxx-large);font-weight:var(--sc-font-weight-bold);white-space:nowrap}.selected-price__interval{font-weight:var(--sc-font-weight-bold);opacity:0.65;white-space:nowrap}.selected-price__scratch-price{opacity:0.65;font-weight:var(--sc-font-weight-normal);text-decoration:line-through}",ScProductSelectedPrice=class{constructor(e){index.registerInstance(this,e),this.scUpdateLineItem=index.createEvent(this,"scUpdateLineItem",7)}lineItem(){return getters.getLineItemByProductId(this.productId)}componentWillLoad(){watchers.onChange("checkout",(()=>{var e,t,i;this.adHocAmount=(null===(e=this.lineItem())||void 0===e?void 0:e.ad_hoc_amount)||(null===(i=null===(t=this.lineItem())||void 0===t?void 0:t.price)||void 0===i?void 0:i.amount)}))}updatePrice(){var e,t,i;this.showInput=!1,(this.adHocAmount||0===this.adHocAmount)&&this.adHocAmount!==(null===(e=this.lineItem())||void 0===e?void 0:e.ad_hoc_amount)&&this.scUpdateLineItem.emit({price_id:null===(i=null===(t=this.lineItem())||void 0===t?void 0:t.price)||void 0===i?void 0:i.id,quantity:1,ad_hoc_amount:this.adHocAmount})}handleShowInputChange(e){e&&setTimeout((()=>{this.input.triggerFocus()}),50)}render(){var e,t,i,c,r;const n=null===(e=this.lineItem())||void 0===e?void 0:e.price;return n?index.h("div",{class:{"selected-price":!0}},this.showInput?index.h("sc-form",{onScSubmit:e=>{e.preventDefault(),e.stopImmediatePropagation(),this.updatePrice()},onScFormSubmit:e=>{e.preventDefault(),e.stopImmediatePropagation()}},index.h("sc-price-input",{ref:e=>this.input=e,size:"large","currency-code":(null==n?void 0:n.currency)||"usd",min:null==n?void 0:n.ad_hoc_min_amount,max:null==n?void 0:n.ad_hoc_max_amount,placeholder:"0.00",required:!0,value:null===(i=null===(t=this.adHocAmount)||void 0===t?void 0:t.toString)||void 0===i?void 0:i.call(t),onScInput:e=>this.adHocAmount=parseInt(e.target.value)},index.h("sc-button",{slot:"suffix",type:"link",submit:!0},wp.i18n.__("Update","surecart")))):index.h(index.Fragment,null,index.h("div",{class:"selected-price__wrap"},index.h("span",{class:"selected-price__price"},(null==n?void 0:n.scratch_amount)>n.amount&&index.h(index.Fragment,null,index.h("sc-format-number",{class:"selected-price__scratch-price",part:"price__scratch",type:"currency",currency:null==n?void 0:n.currency,value:null==n?void 0:n.scratch_amount})," "),index.h("sc-format-number",{type:"currency",currency:null==n?void 0:n.currency,value:null!==(null===(c=this.lineItem())||void 0===c?void 0:c.ad_hoc_amount)?null===(r=this.lineItem())||void 0===r?void 0:r.ad_hoc_amount:null==n?void 0:n.amount})),index.h("span",{class:"selected-price__interval"},price.intervalString(n,{labels:{interval:"/",period:
/** translators: used as in time period: "for 3 months" */
wp.i18n.__("for","surecart")}}))),(null==n?void 0:n.ad_hoc)&&!getters$1.formBusy()&&index.h("sc-button",{class:"selected-price__change-amount",type:"primary",size:"small",onClick:()=>this.showInput=!0},index.h("sc-icon",{name:"edit",slot:"prefix"}),wp.i18n.__("Change Amount","surecart")))):index.h(index.Host,{style:{display:"none"}})}static get watchers(){return{showInput:["handleShowInputChange"]}}};ScProductSelectedPrice.style=scProductSelectedPriceCss,exports.sc_product_selected_price=ScProductSelectedPrice;