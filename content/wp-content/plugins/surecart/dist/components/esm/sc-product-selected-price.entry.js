import{r as registerInstance,c as createEvent,h,F as Fragment,H as Host}from"./index-fd4790f6.js";import{i as intervalString}from"./price-a4ea8b5f.js";import{g as getLineItemByProductId}from"./getters-edc6a0db.js";import{f as formBusy}from"./getters-1925da80.js";import{o as onChange}from"./watchers-0c79cf4e.js";import"./store-3645d641.js";import"./index-26bbcef3.js";import"./add-query-args-f4c5962b.js";const scProductSelectedPriceCss=":host{display:block}sc-form{width:100%}.selected-price{display:flex;align-items:center;gap:var(--sc-spacing-small);flex-wrap:wrap}.selected-price__wrap{display:flex;align-items:baseline;flex-wrap:wrap;gap:var(--sc-spacing-xx-small);color:var(--sc-selected-price-color, var(--sc-color-gray-800));line-height:1}.selected-price__price{font-size:var(--sc-font-size-xxx-large);font-weight:var(--sc-font-weight-bold);white-space:nowrap}.selected-price__interval{font-weight:var(--sc-font-weight-bold);opacity:0.65;white-space:nowrap}.selected-price__scratch-price{opacity:0.65;font-weight:var(--sc-font-weight-normal);text-decoration:line-through}",ScProductSelectedPrice=class{constructor(e){registerInstance(this,e),this.scUpdateLineItem=createEvent(this,"scUpdateLineItem",7)}lineItem(){return getLineItemByProductId(this.productId)}componentWillLoad(){onChange("checkout",(()=>{var e,t,i;this.adHocAmount=(null===(e=this.lineItem())||void 0===e?void 0:e.ad_hoc_amount)||(null===(i=null===(t=this.lineItem())||void 0===t?void 0:t.price)||void 0===i?void 0:i.amount)}))}updatePrice(){var e,t,i;this.showInput=!1,(this.adHocAmount||0===this.adHocAmount)&&this.adHocAmount!==(null===(e=this.lineItem())||void 0===e?void 0:e.ad_hoc_amount)&&this.scUpdateLineItem.emit({price_id:null===(i=null===(t=this.lineItem())||void 0===t?void 0:t.price)||void 0===i?void 0:i.id,quantity:1,ad_hoc_amount:this.adHocAmount})}handleShowInputChange(e){e&&setTimeout((()=>{this.input.triggerFocus()}),50)}render(){var e,t,i,c,r;const o=null===(e=this.lineItem())||void 0===e?void 0:e.price;return o?h("div",{class:{"selected-price":!0}},this.showInput?h("sc-form",{onScSubmit:e=>{e.preventDefault(),e.stopImmediatePropagation(),this.updatePrice()},onScFormSubmit:e=>{e.preventDefault(),e.stopImmediatePropagation()}},h("sc-price-input",{ref:e=>this.input=e,size:"large","currency-code":(null==o?void 0:o.currency)||"usd",min:null==o?void 0:o.ad_hoc_min_amount,max:null==o?void 0:o.ad_hoc_max_amount,placeholder:"0.00",required:!0,value:null===(i=null===(t=this.adHocAmount)||void 0===t?void 0:t.toString)||void 0===i?void 0:i.call(t),onScInput:e=>this.adHocAmount=parseInt(e.target.value)},h("sc-button",{slot:"suffix",type:"link",submit:!0},wp.i18n.__("Update","surecart")))):h(Fragment,null,h("div",{class:"selected-price__wrap"},h("span",{class:"selected-price__price"},(null==o?void 0:o.scratch_amount)>o.amount&&h(Fragment,null,h("sc-format-number",{class:"selected-price__scratch-price",part:"price__scratch",type:"currency",currency:null==o?void 0:o.currency,value:null==o?void 0:o.scratch_amount})," "),h("sc-format-number",{type:"currency",currency:null==o?void 0:o.currency,value:null!==(null===(c=this.lineItem())||void 0===c?void 0:c.ad_hoc_amount)?null===(r=this.lineItem())||void 0===r?void 0:r.ad_hoc_amount:null==o?void 0:o.amount})),h("span",{class:"selected-price__interval"},intervalString(o,{labels:{interval:"/",period:
/** translators: used as in time period: "for 3 months" */
wp.i18n.__("for","surecart")}}))),(null==o?void 0:o.ad_hoc)&&!formBusy()&&h("sc-button",{class:"selected-price__change-amount",type:"primary",size:"small",onClick:()=>this.showInput=!0},h("sc-icon",{name:"edit",slot:"prefix"}),wp.i18n.__("Change Amount","surecart")))):h(Host,{style:{display:"none"}})}static get watchers(){return{showInput:["handleShowInputChange"]}}};ScProductSelectedPrice.style=scProductSelectedPriceCss;export{ScProductSelectedPrice as sc_product_selected_price};