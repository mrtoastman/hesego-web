import{r as s,c as i,h as t,g as e,F as r}from"./p-dfbe004d.js";import{c as l,h as o}from"./p-9cc61896.js";import{r as a}from"./p-f1a6f9ec.js";import{o as n}from"./p-d63f2554.js";import{a as d}from"./p-afcbd440.js";import{i as c}from"./p-468023a1.js";import{a as u}from"./p-10aa7556.js";import{l as h,u as p}from"./p-30ecac60.js";import{c as v}from"./p-ec9ca067.js";import"./p-35c4916d.js";import"./p-1c2e2695.js";import"./p-47d251a3.js";import"./p-ea78c070.js";import"./p-0bb69f38.js";import"./p-9b6c2663.js";import"./p-d8453138.js";import"./p-4d73f82a.js";const m=class{constructor(e){s(this,e),this.scChangeAddress=i(this,"scChangeAddress",7),this.scInputAddress=i(this,"scInputAddress",7),this.address={country:null,city:null,line_1:null,line_2:null,postal_code:null,state:null},this.names={country:"shipping_country",city:"shipping_city",line_1:"shipping_line_1",line_2:"shipping_line_2",postal_code:"shipping_postal_code",state:"shipping_state"},this.placeholders={country:"",postal_code:"",state:""},this.label=wp.i18n.__("Country or region","surecart"),this.countryChoices=l}handleAddressChange(){this.address.country&&(this.setRegions(),this.showState=["US","CA"].includes(this.address.country),this.showPostal=["US"].includes(this.address.country),this.scChangeAddress.emit(this.address),this.scInputAddress.emit(this.address))}updateAddress(e){this.address={...this.address,...e}}handleAddressInput(e){this.scInputAddress.emit({...this.address,...e})}clearAddress(){this.address={country:null,line_1:null,line_2:null,city:null,postal_code:null,state:null}}setRegions(){o(this.address.country)?import("./p-59916e56.js").then((e=>{this.regions=null==e?void 0:e[this.address.country]})):this.regions=[]}componentWillLoad(){var e;this.handleAddressChange();const t=null===(e=this.countryChoices.find((e=>e.value===this.address.country)))||void 0===e?void 0:e.value;t&&this.updateAddress({country:t})}async reportValidity(){return a(this.el)}getStatePlaceholder(){var e,t;return(null===(e=this.placeholders)||void 0===e?void 0:e.state)?this.placeholders.state:"US"===(null===(t=this.address)||void 0===t?void 0:t.country)?wp.i18n.__("State","surecart"):wp.i18n.__("Province/Region","surecart")}render(){var e,s,i,r,a;return t("div",{class:"sc-address",part:"base"},t("sc-form-control",{exportparts:"label, help-text, form-control",label:this.label,class:"sc-address__control",part:"control",required:this.required},t("sc-select",{exportparts:"base:select__base, input, form-control, label, help-text, trigger, panel, caret, search__base, search__input, search__form-control, menu__base, spinner__base, empty",value:null===(e=this.address)||void 0===e?void 0:e.country,onScChange:e=>{this.clearAddress(),this.updateAddress({country:e.target.value||null})},choices:this.countryChoices,autocomplete:"country-name",placeholder:(null===(s=this.placeholders)||void 0===s?void 0:s.country)||wp.i18n.__("Select Your Country","surecart"),name:this.names.country,search:!0,unselect:!1,"squared-bottom":this.showState||this.showPostal,required:this.required}),t("div",{class:"sc-address__columns"},this.showState&&t("sc-select",{exportparts:"base:select__base, input, form-control, label, help-text, trigger, panel, caret, search__base, search__input, search__form-control, menu__base, spinner__base, empty",placeholder:this.getStatePlaceholder(),name:this.names.state,autocomplete:"address-level1",value:null===(i=null==this?void 0:this.address)||void 0===i?void 0:i.state,onScChange:e=>this.updateAddress({state:e.target.value||null}),choices:this.regions,required:this.required,search:!0,"squared-top":!0,unselect:!1,"squared-right":this.showPostal}),this.showPostal&&t("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",placeholder:(null===(r=this.placeholders)||void 0===r?void 0:r.postal_code)||wp.i18n.__("Postal Code/Zip","surecart"),name:this.names.postal_code,onScChange:e=>this.updateAddress({postal_code:e.target.value||null}),onScInput:e=>this.handleAddressInput({name:e.target.value||null}),autocomplete:"postal-code",required:this.required,value:null===(a=null==this?void 0:this.address)||void 0===a?void 0:a.postal_code,"squared-top":!0,maxlength:5,"squared-left":this.showState}))),this.loading&&t("sc-block-ui",{exportparts:"base:block-ui, content:block-ui__content"}))}get el(){return e(this)}static get watchers(){return{address:["handleAddressChange"]}}};m.style=":host{display:block}.sc-address{display:block;position:relative}.sc-address [hidden]{display:none}.sc-address--loading{min-height:70px}.sc-address--loading sc-skeleton{display:block;margin-bottom:1em}.sc-address__control{display:block}.sc-address__control>*{margin-bottom:-1px}.sc-address__columns{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;justify-content:space-between}.sc-address__columns>*{flex:1;width:50%;margin-left:-1px}.sc-address__columns>*:first-child{margin-left:0}";const _=class{constructor(e){s(this,e)}renderLabel(){var e,s,i;let a=wp.i18n.sprintf(wp.i18n.__("Estimated %s","surecart"),(null===(e=null==this?void 0:this.order)||void 0===e?void 0:e.tax_label)||"");return"calculated"===(null===(s=null==this?void 0:this.order)||void 0===s?void 0:s.tax_status)&&(a=(null===(i=this.order)||void 0===i?void 0:i.tax_label)||""),t(r,null,`${wp.i18n.__("Tax:","surecart")} ${a}`,this.renderPercent())}renderPercent(){var e;return(null===(e=this.order)||void 0===e?void 0:e.tax_percent)?t(r,null,"(",this.order.tax_percent,"%",")"):""}render(){var e,s,i,r,a,o,l;return(null===(e=null==this?void 0:this.order)||void 0===e?void 0:e.tax_amount)?t("sc-line-item",null,t("span",{slot:"description"},this.renderLabel()),(null===(s=this.order)||void 0===s?void 0:s.tax_exclusive_amount)&&t("span",{slot:"price"},t("sc-format-number",{type:"currency",currency:(null===(i=null==this?void 0:this.order)||void 0===i?void 0:i.currency)||"usd",value:null===(r=null==this?void 0:this.order)||void 0===r?void 0:r.tax_exclusive_amount})),(null===(a=this.order)||void 0===a?void 0:a.tax_inclusive_amount)&&t("span",{slot:"price-description"},"(",t("sc-format-number",{type:"currency",currency:(null===(o=null==this?void 0:this.order)||void 0===o?void 0:o.currency)||"usd",value:null===(l=null==this?void 0:this.order)||void 0===l?void 0:l.tax_inclusive_amount})," ",wp.i18n.__("included","surecart"),")")):null}};n(_,["order","loading"],!1),_.style=":host{display:block}";const b=class{constructor(e){s(this,e),this.scAddLineItem=i(this,"scAddLineItem",7),this.scRemoveLineItem=i(this,"scRemoveLineItem",7)}updateLineItem(e){var t,s,i;const r=(null===(t=this.bump.price)||void 0===t?void 0:t.id)||(null===(s=this.bump)||void 0===s?void 0:s.price);e?this.scAddLineItem.emit({bump:null===(i=this.bump)||void 0===i?void 0:i.id,price_id:r,quantity:1}):this.scRemoveLineItem.emit({price_id:r,quantity:1})}newPrice(){var e,t,s,i,r,a;let o=null,l=(null===(t=null===(e=this.bump)||void 0===e?void 0:e.price)||void 0===t?void 0:t.amount)||0;if((null===(s=this.bump)||void 0===s?void 0:s.amount_off)&&(o=Math.max(0,l-(null===(i=this.bump)||void 0===i?void 0:i.amount_off))),null===(r=this.bump)||void 0===r?void 0:r.percent_off){const e=l*((null===(a=this.bump)||void 0===a?void 0:a.percent_off)/100);o=Math.max(0,l-e)}return o}renderInterval(){var e;const s=c(null===(e=this.bump)||void 0===e?void 0:e.price,{labels:{interval:"/",period:wp.i18n.__("for","surecart")}});return s.trim().length?t("span",{class:"bump__interval"},s):null}renderPrice(){var e,s,i,r,a,o,l;return t("div",{slot:"description",class:{bump__price:!0,"bump__price--has-discount":!!(null===(e=this.bump)||void 0===e?void 0:e.percent_off)||!!(null===(s=this.bump)||void 0===s?void 0:s.amount_off)},part:"price"},t("sc-format-number",{type:"currency",class:"bump__original-price",value:null===(r=null===(i=this.bump)||void 0===i?void 0:i.price)||void 0===r?void 0:r.amount,currency:null===(o=null===(a=this.bump)||void 0===a?void 0:a.price)||void 0===o?void 0:o.currency})," ",0===this.newPrice()&&wp.i18n.__("Free","surecart"),null!==this.newPrice()&&this.newPrice()>0&&t("sc-format-number",{type:"currency",class:"bump__new-price",value:this.newPrice(),currency:(null===(l=this.bump)||void 0===l?void 0:l.price).currency}),this.renderInterval())}renderDiscount(){var e,s,i,r,a;return(null===(e=this.bump)||void 0===e?void 0:e.amount_off)?t("div",{class:"bump__tag"},wp.i18n.__("Save","surecart")," ",t("sc-format-number",{type:"currency",value:-(null===(s=this.bump)||void 0===s?void 0:s.amount_off),currency:(null===(i=this.bump)||void 0===i?void 0:i.price).currency})):(null===(r=this.bump)||void 0===r?void 0:r.percent_off)?t("div",{class:"bump__tag"},wp.i18n.sprintf(wp.i18n.__("Save %s%%","surecart"),null===(a=this.bump)||void 0===a?void 0:a.percent_off)):void 0}render(){var e,s,i,r,a,o,l,n,c,u,p,h,_,m;const v=null===(s=null===(e=this.bump)||void 0===e?void 0:e.price)||void 0===s?void 0:s.product;return t("sc-choice",{value:null===(i=this.bump)||void 0===i?void 0:i.id,type:"checkbox",showControl:this.showControl,checked:d(this.bump,this.checkout),onScChange:e=>this.updateLineItem(e.target.checked),exportparts:"base, control, checked-icon, title"},t("div",{part:"base-content",class:"bump"},t("div",{class:"bump__text"},t("div",{class:"bump__title"},(null===(a=null===(r=this.bump)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.cta)||(null===(o=this.bump)||void 0===o?void 0:o.name)||(null==v?void 0:v.name)),t("div",{class:"bump__amount"},this.renderPrice()," ",this.renderDiscount()))),(null===(n=null===(l=this.bump)||void 0===l?void 0:l.metadata)||void 0===n?void 0:n.description)&&t("div",{slot:"footer"},t("sc-divider",{style:{"--spacing":"var(--sc-spacing-medium)"}}),t("div",{class:"bump__product"},!!(null==v?void 0:v.image_url)&&t("img",{src:v.image_url,class:"bump__image"}),t("div",{class:"bump__product-text"},!!(null===(u=null===(c=this.bump)||void 0===c?void 0:c.metadata)||void 0===u?void 0:u.cta)&&t("div",{class:"bump__product-title"},this.bump.name||(null==v?void 0:v.name)),!!(null===(h=null===(p=this.bump)||void 0===p?void 0:p.metadata)||void 0===h?void 0:h.description)&&t("div",{class:"bump__product-description"},null===(m=null===(_=this.bump)||void 0===_?void 0:_.metadata)||void 0===m?void 0:m.description)))))}};b.style=":host{display:block}.bump{display:grid;gap:1em}.bump__text{display:grid;gap:0.25em}.bump__tag{background:var(--sc-color-primary-500);color:var(--sc-color-white);border-radius:var(--sc-input-border-radius-medium);padding:var(--sc-spacing-x-small);font-size:var(--sc-font-size-x-small)}.bump__product{display:flex;align-items:center;gap:var(--sc-choice-padding, 1.3em 1.1em);line-height:var(--sc-line-height-dense)}.bump__product-title{font-weight:var(--sc-font-weight-semibold)}.bump__product-description{color:var(--sc-input-label-color)}.bump__image{width:var(--sc-product-line-item-image-size, 4em);height:var(--sc-product-line-item-image-size, 4em);flex:0 0 var(--sc-product-line-item-image-size, 4em);object-fit:cover;border-radius:4px;border:1px solid var(--sc-color-gray-200);display:block;box-shadow:var(--sc-input-box-shadow)}.bump__price--has-discount .bump__original-price{text-decoration:line-through;color:var(--sc-color-gray-500);font-size:var(--sc-font-size-small)}.bump__price .bump__new-price{font-size:var(--sc-font-size-large);color:var(--sc-color-gray-700)}.bump__price .bump__interval{color:var(--sc-color-gray-500)}.bump__amount{display:flex;align-items:center;gap:var(--sc-spacing-x-small);flex-wrap:wrap;margin-top:var(--sc-spacing-xx-small)}";const g=class{constructor(e){s(this,e)}render(){var e;return(null===(e=null==this?void 0:this.bumps)||void 0===e?void 0:e.length)?t("sc-form-control",{label:this.label||wp.i18n.__("Recommended","surecart"),help:this.help},t("div",{class:"bumps__list"},(this.bumps||[]).map((e=>t("sc-order-bump",{key:null==e?void 0:e.id,showControl:this.showControl,bump:e,checkout:this.checkout}))))):null}};n(g,["bumps","checkout"],!1),g.style=":host{display:block}.bumps__list{display:grid;gap:10px}";const y=class{constructor(e){s(this,e),this.scUpdateOrder=i(this,"scUpdateOrder",7),this.required=!1,this.namePlaceholder=wp.i18n.__("Name or Company Name","surecart"),this.countryPlaceholder=wp.i18n.__("Country","surecart"),this.cityPlaceholder=wp.i18n.__("City","surecart"),this.line1Placeholder=wp.i18n.__("Address","surecart"),this.line2Placeholder=wp.i18n.__("Address Line 2","surecart"),this.postalCodePlaceholder=wp.i18n.__("Postal Code/Zip","surecart"),this.statePlaceholder=wp.i18n.__("State/Province/Region","surecart"),this.placeholders={name:wp.i18n.__("Name or Company Name","surecart"),country:wp.i18n.__("Country","surecart"),city:wp.i18n.__("City","surecart"),line_1:wp.i18n.__("Address","surecart"),line_2:wp.i18n.__("Address Line 2","surecart"),postal_code:wp.i18n.__("Postal Code/Zip","surecart"),state:wp.i18n.__("State/Province/Region","surecart")},this.address={country:null,city:null,line_1:null,line_2:null,postal_code:null,state:null}}handleCustomerAddressChange(e,t){(null==e?void 0:e.id)&&!t&&(this.address={...this.address,...e})}async updateAddressState(e){if(JSON.stringify(e)!==JSON.stringify(this.address)){this.address=e;try{h("shipping-address"),u.checkout=await v({id:u.checkout.id,data:{shipping_address:this.address}})}catch(e){console.error(e)}finally{p("shipping-address")}}}async reportValidity(){return this.input.reportValidity()}componentWillLoad(){this.defaultCountry&&!this.address.country&&(this.address.country=this.defaultCountry),this.handleRequirementChange()}handleRequirementChange(){(this.shippingEnabled||this.taxEnabled)&&(this.required=!0)}render(){return this.shippingEnabled||this.full?t("sc-address",{exportparts:"label, help-text, form-control, input__base, select__base, columns, search__base, menu__base",ref:e=>this.input=e,label:this.label||wp.i18n.__("Shipping Address","surecart"),placeholders:{name:this.namePlaceholder,country:this.countryPlaceholder,city:this.cityPlaceholder,line_1:this.line1Placeholder,line_2:this.line2Placeholder,postal_code:this.postalCodePlaceholder,state:this.statePlaceholder},required:this.required,loading:this.loading,address:this.address,"show-name":this.showName,onScChangeAddress:e=>this.updateAddressState(e.detail)}):t("sc-compact-address",{ref:e=>this.input=e,required:this.required,loading:this.loading,address:this.address,placeholders:{name:this.namePlaceholder,country:this.countryPlaceholder,city:this.cityPlaceholder,line_1:this.line1Placeholder,line_2:this.line2Placeholder,postal_code:this.postalCodePlaceholder,state:this.statePlaceholder},label:this.label,onScChangeAddress:e=>this.updateAddressState(e.detail)})}static get watchers(){return{shippingAddress:["handleCustomerAddressChange"],shippingEnabled:["handleRequirementChange"],taxEnabled:["handleRequirementChange"]}}};n(y,["shippingAddress","loading","taxStatus","taxEnabled","shippingEnabled"],!1),y.style=":host{display:block}.sc-order-shipping__loading{display:flex;flex-direction:column;gap:0.5em}";const f=class{constructor(e){s(this,e),this.scUpdateOrder=i(this,"scUpdateOrder",7),this.scError=i(this,"scError",7),this.show=!1,this.busy=!1}getStatus(){var e,t,s;return"eu_vat"!==(null===(e=this.taxIdentifier)||void 0===e?void 0:e.number_type)||"apply_reverse_charge"===(null===(t=this.taxProtocol)||void 0===t?void 0:t.eu_vat_unverified_behavior)?"unknown":(null===(s=this.taxIdentifier)||void 0===s?void 0:s.eu_vat_verified)?"valid":"invalid"}async maybeUpdateOrder(e){try{h("tax_identifier"),u.checkout=await v({id:u.checkout.id,data:{tax_identifier:e}})}catch(e){console.error(e),this.scError.emit(e)}finally{p("tax_identifier")}}render(){var e,s,i,r,a,o;return t("sc-tax-id-input",{show:this.show,number:null===(s=null===(e=this.order)||void 0===e?void 0:e.tax_identifier)||void 0===s?void 0:s.number,type:null===(r=null===(i=this.order)||void 0===i?void 0:i.tax_identifier)||void 0===r?void 0:r.number_type,country:null===(o=null===(a=null==this?void 0:this.order)||void 0===a?void 0:a.shipping_address)||void 0===o?void 0:o.country,status:this.getStatus(),loading:this.busy,onScChange:e=>{e.stopImmediatePropagation(),this.maybeUpdateOrder(e.detail)},otherLabel:this.otherLabel,caGstLabel:this.caGstLabel,auAbnLabel:this.auAbnLabel,gbVatLabel:this.gbVatLabel,euVatLabel:this.euVatLabel})}};n(f,["draft","order","tax_status","taxIdentifier","taxProtocol","busy"],!1),f.style=":host{display:block}";export{m as sc_compact_address,_ as sc_line_item_tax,b as sc_order_bump,g as sc_order_bumps,y as sc_order_shipping_address,f as sc_order_tax_id_input};