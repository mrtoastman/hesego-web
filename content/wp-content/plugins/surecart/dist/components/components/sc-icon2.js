import{proxyCustomElement,HTMLElement,createEvent,h}from"@stencil/core/internal/client";let registry=[],watchedIcons=[];function getIconLibrary(t){return registry.filter((e=>e.name===t))[0]}function registerIconLibrary(t,e){unregisterIconLibrary(t),registry.push({name:t,resolver:e.resolver,mutator:e.mutator}),watchedIcons.map((e=>{e.library===t&&e.redraw()}))}function unregisterIconLibrary(t){registry=registry.filter((e=>e.name!==t))}window.ceRegisterIconLibrary=registerIconLibrary;const iconFiles=new Map,requestIcon=t=>{if(iconFiles.has(t))return iconFiles.get(t);{const e=fetch(t).then((async t=>{if(t.ok){const e=document.createElement("div");e.innerHTML=await t.text();const s=e.firstElementChild;return{ok:t.ok,status:t.status,svg:s&&"svg"===s.tagName.toLowerCase()?s.outerHTML:""}}return{ok:t.ok,status:t.status,svg:null}}));return iconFiles.set(t,e),e}},scIconCss=":host{--width:1em;--height:1em;display:inline-block;width:var(--width);height:var(--height);contain:strict;box-sizing:content-box !important}.icon,svg{display:block;height:100%;width:100%;stroke-width:var(--sc-icon-stroke-width, 2px)}",parser=new DOMParser,ScIcon=proxyCustomElement(class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.scLoad=createEvent(this,"scLoad",7),this.scError=createEvent(this,"scError",7),this.svg="",this.library="default"}redraw(){this.setIcon()}componentWillLoad(){this.setIcon()}getLabel(){let t="";return this.label?t=this.label:this.name?t=this.name.replace(/-/g," "):this.src&&(t=this.src.replace(/.*\//,"").replace(/-/g," ").replace(/\.svg/i,"")),t}async setIcon(){const t=getIconLibrary(this.library),e=this.getUrl();if(e)try{const s=await requestIcon(e);if(e!==this.getUrl())return;if(s.ok){const e=parser.parseFromString(s.svg,"text/html").body.querySelector("svg");e?(t&&t.mutator&&t.mutator(e),this.svg=e.outerHTML,this.scLoad.emit()):(this.svg="",this.scError.emit({status:s.status}))}else this.svg="",this.scError.emit({status:s.status})}catch{this.scError.emit({status:-1})}else this.svg&&(this.svg="")}getUrl(){const t=getIconLibrary(this.library);return this.name&&t?t.resolver(this.name):this.src}render(){return h("div",{part:"base",class:"icon",role:"img","aria-label":this.getLabel(),innerHTML:this.svg})}static get assetsDirs(){return["icon-assets"]}static get watchers(){return{name:["setIcon"],src:["setIcon"],library:["setIcon"]}}static get style(){return scIconCss}},[1,"sc-icon",{name:[513],src:[1],label:[1],library:[1],svg:[32]}]);function defineCustomElement(){"undefined"!=typeof customElements&&["sc-icon"].forEach((t=>{"sc-icon"===t&&(customElements.get(t)||customElements.define(t,ScIcon))}))}defineCustomElement();export{ScIcon as S,defineCustomElement as d,registerIconLibrary as r};