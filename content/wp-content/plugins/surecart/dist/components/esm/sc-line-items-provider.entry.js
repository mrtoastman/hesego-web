import{r as registerInstance,c as createEvent,h}from"./index-fd4790f6.js";import{c as convertLineItemsToLineItemData}from"./index-1ef9aa85.js";const ScLineItemsProvider=class{constructor(e){registerInstance(this,e),this.scUpdateLineItems=createEvent(this,"scUpdateLineItems",7),this.syncItems=[]}handleLineItemToggle(e){const t=e.detail;this.addSyncItem("toggle",t)}handleLineItemRemove(e){const t=e.detail;this.addSyncItem("remove",t)}handleLineItemAdd(e){const t=e.detail;this.addSyncItem("add",t)}handleLineItemUpdate(e){const t=e.detail;this.addSyncItem("update",t)}async syncItemsHandler(e){(null==e?void 0:e.length)&&setTimeout((()=>{var e;if(!(null===(e=this.syncItems)||void 0===e?void 0:e.length))return;const t=this.processSyncItems();this.scUpdateLineItems.emit(t),this.syncItems=[]}),100)}addSyncItem(e,t){this.syncItems=[...this.syncItems,{type:e,payload:t}]}processSyncItems(){var e;let t=convertLineItemsToLineItemData((null===(e=null==this?void 0:this.order)||void 0===e?void 0:e.line_items)||[]);const i={toggle:this.toggleItem,add:this.addItem,remove:this.removeItem,update:this.updateItem};return(this.syncItems||[]).forEach((e=>{t=i[e.type](e.payload,t)})),t}addItem(e,t){return[...t,e]}toggleItem(e,t){var i;const s=null===(i=t.find((t=>t.price_id===e.price_id)))||void 0===i?void 0:i.price_id;return s?t.filter((e=>s!==e.price_id)):[...t,e]}removeItem(e,t){return e.price_id?t.filter((t=>t.price_id!==e.price_id)):t}updateItem(e,t){const i=t.findIndex((t=>t.price_id===e.price_id));return-1===i?[...t,e]:(t[i]=e,t)}render(){return h("slot",null)}static get watchers(){return{syncItems:["syncItemsHandler"]}}};export{ScLineItemsProvider as sc_line_items_provider};