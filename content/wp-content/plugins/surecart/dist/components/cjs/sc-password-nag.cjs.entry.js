"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const index=require("./index-9c866aeb.js"),fetch=require("./fetch-b673a242.js");require("./add-query-args-17c551b6.js");const scPasswordNagCss=":host{display:block}",ScPasswordNag=class{constructor(s){index.registerInstance(this,s),this.open=!0,this.type="primary"}handleSetChange(){setTimeout((()=>{this.input&&this.input.triggerFocus()}),50)}async dismiss(){this.loading=!0,this.error="";try{await fetch.apiFetch({path:"wp/v2/users/me",method:"PATCH",data:{meta:{default_password_nag:!1}}}),this.open=!1}catch(s){this.error=(null==s?void 0:s.message)||wp.i18n.__("Something went wrong","surecart"),this.loading=!1}}async handleSubmit(s){this.loading=!0,this.error="";try{const{password:e,password_confirm:t}=await s.target.getFormJson();if(e!==t)throw{message:wp.i18n.__("Passwords do not match.","surecart")};await fetch.apiFetch({path:"wp/v2/users/me",method:"PATCH",data:{password:e,meta:{default_password_nag:!1}}}),this.dismiss(),this.success=!0}catch(s){this.error=(null==s?void 0:s.message)||wp.i18n.__("Something went wrong","surecart"),this.loading=!1}}render(){return this.success?index.h("sc-alert",{type:"success",open:!0},index.h("span",{slot:"title"},wp.i18n.__("Succcess!","surecart")),wp.i18n.__("You have successfully set your password.","surecart")):index.h("sc-alert",{type:this.type,open:this.open,exportparts:"base, icon, text, title, message, close-icon",style:{position:"relative"}},!!this.error&&this.error,this.set?index.h("sc-dashboard-module",{class:"customer-details"},index.h("span",{slot:"heading"},wp.i18n.__("Set A Password","surecart")," "),index.h("sc-button",{type:"text",size:"small",slot:"end",onClick:()=>this.set=!1},index.h("sc-icon",{name:"x",slot:"prefix"}),wp.i18n.__("Cancel","surecart")),index.h("sc-card",null,index.h("sc-form",{onScFormSubmit:s=>this.handleSubmit(s)},index.h("sc-input",{label:wp.i18n.__("New Password","surecart"),name:"password",type:"password",required:!0,ref:s=>this.input=s}),index.h("sc-input",{label:wp.i18n.__("Confirm New Password","surecart"),name:"password_confirm",type:"password",required:!0}),index.h("div",null,index.h("sc-button",{type:"primary",full:!0,submit:!0,busy:this.loading},wp.i18n.__("Update Password","surecart")))))):index.h(index.Fragment,null,index.h("slot",{name:"title",slot:"title"},wp.i18n.__("Reminder","surecart")),index.h("slot",null,wp.i18n.__("You have not yet set a password. Please set a password for your account.","surecart")),index.h("sc-flex",{"justify-content":"flex-start"},index.h("sc-button",{size:"small",type:"primary",onClick:()=>this.set=!0},wp.i18n.__("Set A Password","surecart")),index.h("sc-button",{size:"small",type:"text",onClick:()=>this.dismiss()},wp.i18n.__("Dismiss","surecart")))),this.loading&&index.h("sc-block-ui",{spinner:!0}))}static get watchers(){return{set:["handleSetChange"]}}};ScPasswordNag.style=scPasswordNagCss,exports.sc_password_nag=ScPasswordNag;