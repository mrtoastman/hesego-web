"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const index=require("./index-9c866aeb.js"),watchers$1=require("./watchers-d5742848.js");require("./watchers-be62d6ad.js");const getters=require("./getters-c6087113.js"),watchers=require("./watchers-203d7acd.js"),getters$1=require("./getters-6c916233.js"),mutations=require("./mutations-5cf514b3.js"),fetch=require("./fetch-b673a242.js"),ManualPaymentMethods=require("./ManualPaymentMethods-c235e978.js"),addQueryArgs=require("./add-query-args-17c551b6.js");require("./index-f6f80680.js"),require("./util-98cb3494.js");const listenTo=(e,t,r)=>watchers.on("set",((s,i,n)=>{if(s===e){if(Array.isArray(t)&&t.some((e=>JSON.stringify(null==i?void 0:i[e])!==JSON.stringify(null==n?void 0:n[e]))))return r(i,n);if("string"==typeof t){if(JSON.stringify(null==i?void 0:i[t])===JSON.stringify(null==n?void 0:n[t]))return;return r(null==i?void 0:i[t],null==n?void 0:n[t])}}})),scCheckoutMolliePaymentCss=":host{display:block}",ScCheckoutMolliePayment=class{constructor(e){index.registerInstance(this,e),this.scError=index.createEvent(this,"scError",7)}componentWillLoad(){var e,t;watchers$1.state.id="mollie",this.fetchMethods(),e=["total_amount","currency","reusabled_payment_method_required","shipping_address"],t=()=>this.fetchMethods(),watchers.on("set",((r,s,i)=>{if("checkout"===r){if(Array.isArray(e)&&e.some((e=>JSON.stringify(null==s?void 0:s[e])!==JSON.stringify(null==i?void 0:i[e]))))return t();if("string"==typeof e){if(JSON.stringify(null==s?void 0:s[e])===JSON.stringify(null==i?void 0:i[e]))return;return t(null==s||s[e],null==i||i[e])}}}))}async fetchMethods(){var e;const t=watchers.state.checkout;if((null==t?void 0:t.currency)&&(null==t?void 0:t.total_amount))try{mutations.lockCheckout("methods");const r=await fetch.apiFetch({path:addQueryArgs.addQueryArgs(`surecart/v1/processors/${this.processorId}/payment_method_types`,{amount:null==t?void 0:t.total_amount,country:(null===(e=null==t?void 0:t.shipping_address)||void 0===e?void 0:e.country)||"us",currency:null==t?void 0:t.currency,...(null==t?void 0:t.reusable_payment_method_required)?{reusable:null==t?void 0:t.reusable_payment_method_required}:{},per_page:100})});getters.state.methods=(null==r?void 0:r.data)||[]}catch(e){this.scError.emit(e),console.error(e)}finally{mutations.unLockCheckout("methods")}}renderLoading(){return index.h("sc-card",null,index.h("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),index.h("sc-skeleton",{style:{width:"30%",marginBottom:"0.5em"}}),index.h("sc-skeleton",{style:{width:"60%",marginBottom:"0.5em"}}))}render(){var e,t,r;if(getters$1.checkoutIsLocked("methods")&&!(null===(e=getters.availableMethodTypes())||void 0===e?void 0:e.length))return this.renderLoading();if(!(null===(t=watchers.state.checkout)||void 0===t?void 0:t.currency))return this.renderLoading();if(!(null===(r=getters.availableMethodTypes())||void 0===r?void 0:r.length))return index.h("sc-alert",{type:"warning",open:!0},wp.i18n.__("No available payment methods","surecart")," ");const s=getters.hasMultipleMethodChoices()?"sc-toggles":"div";return index.h(index.Fragment,null,index.h(s,{collapsible:!1,theme:"container"},(getters.availableMethodTypes()||[]).map((e=>index.h("sc-payment-method-choice",{"processor-id":"mollie","method-id":null==e?void 0:e.id,key:null==e?void 0:e.id},index.h("span",{slot:"summary",class:"sc-payment-toggle-summary"},!!(null==e?void 0:e.image)&&index.h("img",{src:null==e?void 0:e.image}),index.h("span",null,null==e?void 0:e.description)),index.h("sc-card",null,index.h("sc-payment-selected",{label:wp.i18n.sprintf(wp.i18n.__("%s selected for check out.","surecart"),null==e?void 0:e.description)},!!(null==e?void 0:e.image)&&index.h("img",{slot:"icon",src:null==e?void 0:e.image,style:{width:"32px"}}),wp.i18n.__("Another step will appear after submitting your order to complete your purchase details.","surecart")))))),index.h(ManualPaymentMethods.ManualPaymentMethods,{methods:getters.availableManualPaymentMethods()})),!!getters$1.checkoutIsLocked("methods")&&index.h("sc-block-ui",{class:"busy-block-ui","z-index":9,style:{"--sc-block-ui-opacity":"0.4"}}))}};ScCheckoutMolliePayment.style=":host{display:block}",exports.sc_checkout_mollie_payment=ScCheckoutMolliePayment;