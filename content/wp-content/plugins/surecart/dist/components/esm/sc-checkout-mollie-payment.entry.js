import{r as registerInstance,c as createEvent,h,F as Fragment}from"./index-fd4790f6.js";import{s as state}from"./watchers-e86a5dda.js";import"./watchers-0c38e1b1.js";import{s as state$1,c as availableMethodTypes,d as hasMultipleMethodChoices,b as availableManualPaymentMethods}from"./getters-c6fb954d.js";import{d as on,a as state$2}from"./watchers-0c79cf4e.js";import{a as checkoutIsLocked}from"./getters-edc6a0db.js";import{l as lockCheckout,u as unLockCheckout}from"./mutations-8030ef46.js";import{a as apiFetch}from"./fetch-34712ac6.js";import{M as ManualPaymentMethods}from"./ManualPaymentMethods-587d7637.js";import{a as addQueryArgs}from"./add-query-args-f4c5962b.js";import"./index-26bbcef3.js";import"./util-1396ff7b.js";const listenTo=(e,t,o)=>on("set",((s,i,r)=>{if(s===e){if(Array.isArray(t)&&t.some((e=>JSON.stringify(null==i?void 0:i[e])!==JSON.stringify(null==r?void 0:r[e]))))return o(i,r);if("string"==typeof t){if(JSON.stringify(null==i?void 0:i[t])===JSON.stringify(null==r?void 0:r[t]))return;return o(null==i?void 0:i[t],null==r?void 0:r[t])}}})),scCheckoutMolliePaymentCss=":host{display:block}",ScCheckoutMolliePayment=class{constructor(e){registerInstance(this,e),this.scError=createEvent(this,"scError",7)}componentWillLoad(){var e,t;state.id="mollie",this.fetchMethods(),e=["total_amount","currency","reusabled_payment_method_required","shipping_address"],t=()=>this.fetchMethods(),on("set",((o,s,i)=>{if("checkout"===o){if(Array.isArray(e)&&e.some((e=>JSON.stringify(null==s?void 0:s[e])!==JSON.stringify(null==i?void 0:i[e]))))return t();if("string"==typeof e){if(JSON.stringify(null==s?void 0:s[e])===JSON.stringify(null==i?void 0:i[e]))return;return t(null==s||s[e],null==i||i[e])}}}))}async fetchMethods(){var e;const t=state$2.checkout;if((null==t?void 0:t.currency)&&(null==t?void 0:t.total_amount))try{lockCheckout("methods");const o=await apiFetch({path:addQueryArgs(`surecart/v1/processors/${this.processorId}/payment_method_types`,{amount:null==t?void 0:t.total_amount,country:(null===(e=null==t?void 0:t.shipping_address)||void 0===e?void 0:e.country)||"us",currency:null==t?void 0:t.currency,...(null==t?void 0:t.reusable_payment_method_required)?{reusable:null==t?void 0:t.reusable_payment_method_required}:{},per_page:100})});state$1.methods=(null==o?void 0:o.data)||[]}catch(e){this.scError.emit(e),console.error(e)}finally{unLockCheckout("methods")}}renderLoading(){return h("sc-card",null,h("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),h("sc-skeleton",{style:{width:"30%",marginBottom:"0.5em"}}),h("sc-skeleton",{style:{width:"60%",marginBottom:"0.5em"}}))}render(){var e,t,o;if(checkoutIsLocked("methods")&&!(null===(e=availableMethodTypes())||void 0===e?void 0:e.length))return this.renderLoading();if(!(null===(t=state$2.checkout)||void 0===t?void 0:t.currency))return this.renderLoading();if(!(null===(o=availableMethodTypes())||void 0===o?void 0:o.length))return h("sc-alert",{type:"warning",open:!0},wp.i18n.__("No available payment methods","surecart")," ");const s=hasMultipleMethodChoices()?"sc-toggles":"div";return h(Fragment,null,h(s,{collapsible:!1,theme:"container"},(availableMethodTypes()||[]).map((e=>h("sc-payment-method-choice",{"processor-id":"mollie","method-id":null==e?void 0:e.id,key:null==e?void 0:e.id},h("span",{slot:"summary",class:"sc-payment-toggle-summary"},!!(null==e?void 0:e.image)&&h("img",{src:null==e?void 0:e.image}),h("span",null,null==e?void 0:e.description)),h("sc-card",null,h("sc-payment-selected",{label:wp.i18n.sprintf(wp.i18n.__("%s selected for check out.","surecart"),null==e?void 0:e.description)},!!(null==e?void 0:e.image)&&h("img",{slot:"icon",src:null==e?void 0:e.image,style:{width:"32px"}}),wp.i18n.__("Another step will appear after submitting your order to complete your purchase details.","surecart")))))),h(ManualPaymentMethods,{methods:availableManualPaymentMethods()})),!!checkoutIsLocked("methods")&&h("sc-block-ui",{class:"busy-block-ui","z-index":9,style:{"--sc-block-ui-opacity":"0.4"}}))}};ScCheckoutMolliePayment.style=":host{display:block}";export{ScCheckoutMolliePayment as sc_checkout_mollie_payment};