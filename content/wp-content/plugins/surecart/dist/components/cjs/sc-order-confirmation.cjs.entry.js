"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const index=require("./index-9c866aeb.js"),fetch=require("./fetch-b673a242.js"),universe=require("./universe-28bdab41.js"),getQueryArg=require("./get-query-arg-53bf21e2.js"),addQueryArgs=require("./add-query-args-17c551b6.js"),scOrderConfirmationCss=":host{display:block;max-width:800px;margin:auto}::slotted(*:not(:last-child)),sc-form form>*:not(:last-child){margin-bottom:var(--sc-form-row-spacing-large)}.order-confirmation__content{color:var(--sc-order-confirmation-color, var(--sc-color-gray-500))}.order-confirmation__content.hidden{display:none}::part(line-items){display:grid;gap:0.5em}",ScOrderConfirmation=class{constructor(e){index.registerInstance(this,e),this.loading=!1}componentWillLoad(){universe.Universe.create(this,this.state()),this.getSession()}getSessionId(){var e;return(null===(e=this.order)||void 0===e?void 0:e.id)?this.order.id:getQueryArg.getQueryArg(window.location.href,"order")}async getSession(){var e;if(this.getSessionId()&&!(null===(e=this.order)||void 0===e?void 0:e.id))try{this.loading=!0,this.order=await await fetch.apiFetch({path:addQueryArgs.addQueryArgs(`surecart/v1/checkouts/${this.getSessionId()}`,{expand:["line_items","line_item.price","line_item.fees","price.product","customer","customer.shipping_address","payment_intent","discount","manual_payment_method","discount.promotion","billing_address","shipping_address"],refresh_status:!0})})}catch(e){(null==e?void 0:e.message)?this.error=e.message:this.error=wp.i18n.__("Something went wrong","surecart")}finally{this.loading=!1}}state(){var e,r;const i=null===(e=this.order)||void 0===e?void 0:e.manual_payment_method;return{processor:"stripe",loading:this.loading,orderId:this.getSessionId(),order:this.order,customer:null===(r=this.order)||void 0===r?void 0:r.customer,manualPaymentTitle:null==i?void 0:i.name,manualPaymentInstructions:null==i?void 0:i.instructions}}renderOnHold(){var e,r,i;return"processing"!==(null===(e=this.order)||void 0===e?void 0:e.status)?null:"paypal"===(null===(i=null===(r=null==this?void 0:this.order)||void 0===r?void 0:r.payment_intent)||void 0===i?void 0:i.processor_type)?index.h("sc-alert",{type:"warning",open:!0},wp.i18n.__("Paypal is taking a closer look at this payment. Itâ€™s required for some payments and normally takes up to 3 business days.","surecart")):void 0}renderManualInstructions(){var e;const r=null===(e=this.order)||void 0===e?void 0:e.manual_payment_method;if(null==r?void 0:r.instructions)return index.h("sc-alert",{type:"info",open:!0},index.h("span",{slot:"title"},null==r?void 0:r.name),null==r?void 0:r.instructions)}render(){var e,r;return index.h(universe.Universe.Provider,{state:this.state()},index.h("div",{class:{"order-confirmation":!0}},index.h("div",{class:{"order-confirmation__content":!0,hidden:!(null===(e=this.order)||void 0===e?void 0:e.id)&&!this.loading}},index.h("sc-order-confirm-components-validator",{checkout:this.order},index.h("slot",null))),!(null===(r=this.order)||void 0===r?void 0:r.id)&&!this.loading&&index.h("sc-heading",null,wp.i18n.__("Order not found.","surecart"),index.h("span",{slot:"description"},wp.i18n.__("This order could not be found. Please try again.","surecart")))))}};ScOrderConfirmation.style=scOrderConfirmationCss,exports.sc_order_confirmation=ScOrderConfirmation;