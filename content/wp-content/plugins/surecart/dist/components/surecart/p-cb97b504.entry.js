import{r as i,c as o,h as t,F as s,g as r}from"./p-dfbe004d.js";import{p as e}from"./p-f0bb2283.js";import{o as n}from"./p-d63f2554.js";import{s as l}from"./p-ea78c070.js";import{a as c}from"./p-0bb69f38.js";import"./p-112455b1.js";import"./p-35c4916d.js";import"./p-9b6c2663.js";import"./p-10aa7556.js";import"./p-1c2e2695.js";const a=class{constructor(e){i(this,e),this.scPaid=o(this,"scPaid",7),this.scPayError=o(this,"scPayError",7),this.scSetState=o(this,"scSetState",7),this.mode="live",this.size="medium",this.secureText="",this.showLabel=!0}async componentWillLoad(){const r=(c()||[]).find((e=>"stripe"===e.processor_type));if(!r)return;const{account_id:t,publishable_key:i}=(null==r?void 0:r.processor_data)||{};try{this.stripe=await e.loadStripe(i,{stripeAccount:t}),this.elements=this.stripe.elements()}catch(r){this.error=(null==r?void 0:r.message)||wp.i18n.__("Stripe could not be loaded","surecart")}}async maybeConfirmOrder(e){var r,t,i,o,s,n,a,c,d,p,u,m,h,v,f,b,g,x,y,w,_,k,S;if("paying"===e&&"stripe"===(null==l?void 0:l.id)&&"stripe"===(null===(t=null===(r=this.order)||void 0===r?void 0:r.payment_intent)||void 0===t?void 0:t.processor_type)&&(null===(o=null===(i=this.order)||void 0===i?void 0:i.payment_intent)||void 0===o?void 0:o.external_intent_id)&&(null===(c=null===(a=null===(n=null===(s=this.order)||void 0===s?void 0:s.payment_intent)||void 0===n?void 0:n.processor_data)||void 0===a?void 0:a.stripe)||void 0===c?void 0:c.client_secret)&&(null===(m=null===(u=null===(p=null===(d=this.order)||void 0===d?void 0:d.payment_intent)||void 0===p?void 0:p.processor_data)||void 0===u?void 0:u.stripe)||void 0===m?void 0:m.type)&&!this.confirming){this.confirming=!0;try{let e;if(e="setup"==(null===(b=null===(f=null===(v=null===(h=this.order)||void 0===h?void 0:h.payment_intent)||void 0===v?void 0:v.processor_data)||void 0===f?void 0:f.stripe)||void 0===b?void 0:b.type)?await this.confirmCardSetup(null===(y=null===(x=null===(g=this.order)||void 0===g?void 0:g.payment_intent)||void 0===x?void 0:x.processor_data)||void 0===y?void 0:y.stripe.client_secret):await this.confirmCardPayment(null===(S=null===(k=null===(_=null===(w=this.order)||void 0===w?void 0:w.payment_intent)||void 0===_?void 0:_.processor_data)||void 0===k?void 0:k.stripe)||void 0===S?void 0:S.client_secret),null==e?void 0:e.error)throw this.error=e.error.message,e.error;this.scSetState.emit("PAID"),this.scPaid.emit()}catch(e){this.scPayError.emit(e),e.message&&(this.error=e.message),this.confirming=!1,this.scSetState.emit("REJECT")}}}async confirmCardPayment(e){var r,t;return this.stripe.confirmCardPayment(e,{payment_method:{card:this.element,billing_details:{...(null===(r=null==this?void 0:this.order)||void 0===r?void 0:r.name)?{name:this.order.name}:{},...(null===(t=null==this?void 0:this.order)||void 0===t?void 0:t.email)?{email:this.order.email}:{}}}})}async confirmCardSetup(e){var r,t;return this.stripe.confirmCardSetup(e,{payment_method:{card:this.element,billing_details:{...(null===(r=null==this?void 0:this.order)||void 0===r?void 0:r.name)?{name:this.order.name}:{},...(null===(t=null==this?void 0:this.order)||void 0===t?void 0:t.email)?{email:this.order.email}:{}}}})}componentDidLoad(){if(!this.elements)return;const e=getComputedStyle(document.body);this.elements.create("card",{style:{base:{color:e.getPropertyValue("--sc-input-label-color"),fontSize:"16px",iconColor:e.getPropertyValue("--sc-stripe-icon-color"),fontSmoothing:"antialiased","::placeholder":{color:e.getPropertyValue("--sc-input-placeholder-color")}},invalid:{color:e.getPropertyValue("--sc-color-error-500"),":focus":{color:e.getPropertyValue("--sc-input-label-color")}}}}).mount(this.container),this.element=this.elements.getElement("card"),this.element.on("change",(e=>{var r;return this.error=(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.message)?e.error.message:""})),this.element.on("focus",(()=>this.hasFocus=!0)),this.element.on("blur",(()=>this.hasFocus=!1))}render(){return t(s,null,t("sc-form-control",{class:"sc-stripe",size:this.size,label:this.label},t("div",{class:"sc-stripe-element",ref:e=>this.container=e})),this.error&&t("sc-text",{style:{color:"var(--sc-color-danger-500)","--font-size":"var(--sc-font-size-small)",marginTop:"0.5em"}},this.error))}get el(){return r(this)}static get watchers(){return{formState:["maybeConfirmOrder"]}}};n(a,["order","mode","selectedProcessorId","formState"],!1),a.style="sc-stripe-element{display:block;--focus-ring:0 0 0 var(--sc-focus-ring-width) var(--sc-focus-ring-color-primary)}sc-stripe-element sc-input{--sc-input-height-medium:auto}.sc-stripe *{font-family:var(--sc-input-font-family);font-weight:var(--sc-input-font-weight);font-size:var(--sc-input-font-size)}.sc-stripe-element{border-radius:var(--sc-input-border-radius-medium);font-size:var(--sc-input-font-size-medium);height:var(--sc-input-height-medium);width:100%;box-sizing:border-box !important;background-color:var(--sc-input-background-color);border:solid 1px var(--sc-input-border-color, var(--sc-input-border));box-shadow:var(--sc-input-box-shadow);transition:var(--sc-input-transition, var(--sc-transition-medium)) color, var(--sc-input-transition, var(--sc-transition-medium)) border, var(--sc-input-transition, var(--sc-transition-medium)) box-shadow}.sc-stripe-element:hover{background-color:var(--sc-input-background-color-hover);border-color:var(--sc-input-border-color-hover)}.sc-stripe-element.StripeElement--focus{background-color:var(--sc-input-background-color-focus);border-color:var(--sc-input-border-color-focus);box-shadow:var(--focus-ring)}.sc-stripe fieldset{margin:0 15px 20px;padding:0;border-style:none;background-color:#7795f8;box-shadow:0 6px 9px rgba(50, 50, 93, 0.06), 0 2px 5px rgba(0, 0, 0, 0.08), inset 0 1px 0 #829fff;border-radius:4px}.sc-stripe .row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-left:15px}.sc-stripe .row+.row{border-top:1px solid #819efc}.sc-stripe label{width:15%;min-width:70px;padding:11px 0;color:#c4f0ff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sc-stripe input,.sc-stripe button{-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none;border-style:none}.sc-stripe input:-webkit-autofill{-webkit-text-fill-color:#fce883;transition:background-color 100000000s;-webkit-animation:1ms void-animation-out}.sc-stripe .StripeElement--webkit-autofill{background:transparent !important}.sc-stripe .StripeElement{width:100%;padding:var(--sc-input-spacing-small)}.sc-stripe input{width:100%;padding:11px;color:#fff;background-color:transparent;-webkit-animation:1ms void-animation-out}.sc-stripe input::-webkit-input-placeholder{color:#87bbfd}.sc-stripe input::-moz-placeholder{color:#87bbfd}.sc-stripe input:-ms-input-placeholder{color:#87bbfd}.sc-stripe button{display:block;width:calc(100% - 30px);height:40px;margin:40px 15px 0;background-color:#f6a4eb;box-shadow:0 6px 9px rgba(50, 50, 93, 0.06), 0 2px 5px rgba(0, 0, 0, 0.08), inset 0 1px 0 #ffb9f6;border-radius:4px;color:#fff;font-weight:600;cursor:pointer}.sc-stripe button:active{background-color:#d782d9;box-shadow:0 6px 9px rgba(50, 50, 93, 0.06), 0 2px 5px rgba(0, 0, 0, 0.08), inset 0 1px 0 #e298d8}.sc-stripe .error svg .base{fill:#fff}.sc-stripe .error svg .glyph{fill:#6772e5}.sc-stripe .error .message{color:#fff}.sc-stripe .success .icon .border{stroke:#87bbfd}.sc-stripe .success .icon .checkmark{stroke:#fff}.sc-stripe .success .title{color:#fff}.sc-stripe .success .message{color:#9cdbff}.sc-stripe .success .reset path{fill:#fff}";export{a as sc_stripe_element};